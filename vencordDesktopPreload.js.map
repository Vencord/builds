{
  "version": 3,
  "sources": ["../src/shared/debounce.ts", "../src/preload.ts", "../src/VencordNative.ts"],
  "sourcesContent": ["/*\n * Vencord, a modification for Discord's desktop app\n * Copyright (c) 2022 Vendicated and contributors\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\n/**\n * Returns a new function that will call the wrapped function\n * after the specified delay. If the function is called again\n * within the delay, the timer will be reset.\n * @param func The function to wrap\n * @param delay The delay in milliseconds\n */\nexport function debounce<T extends Function>(func: T, delay = 300): T {\n    let timeout: NodeJS.Timeout;\n    return function (...args: any[]) {\n        clearTimeout(timeout);\n        timeout = setTimeout(() => { func(...args); }, delay);\n    } as any;\n}\n", "/*\n * Vencord, a modification for Discord's desktop app\n * Copyright (c) 2022 Vendicated and contributors\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>.\n*/\n\nimport { debounce } from \"@shared/debounce\";\nimport { IpcEvents } from \"@shared/IpcEvents\";\nimport { contextBridge, webFrame } from \"electron/renderer\";\n\nimport VencordNative, { invoke, sendSync } from \"./VencordNative\";\n\ncontextBridge.exposeInMainWorld(\"VencordNative\", VencordNative);\n\n// Discord\nif (location.protocol !== \"data:\") {\n    invoke(IpcEvents.INIT_FILE_WATCHERS);\n\n    if (IS_DISCORD_DESKTOP) {\n        webFrame.executeJavaScript(sendSync<string>(IpcEvents.PRELOAD_GET_RENDERER_JS));\n        // Not supported in sandboxed preload scripts but Discord doesn't support it either so who cares\n        require(process.env.DISCORD_PRELOAD!);\n    }\n} // Monaco popout\nelse {\n    contextBridge.exposeInMainWorld(\"setCss\", debounce(VencordNative.quickCss.set));\n    contextBridge.exposeInMainWorld(\"getCurrentCss\", VencordNative.quickCss.get);\n    contextBridge.exposeInMainWorld(\"getTheme\", VencordNative.quickCss.getEditorTheme);\n}\n", "/*\n * Vencord, a Discord client mod\n * Copyright (c) 2023 Vendicated and contributors\n * SPDX-License-Identifier: GPL-3.0-or-later\n */\n\nimport type { Settings } from \"@api/Settings\";\nimport type { CspRequestResult } from \"@main/csp/manager\";\nimport type { PluginIpcMappings } from \"@main/ipcPlugins\";\nimport type { UserThemeHeader } from \"@main/themes\";\nimport { IpcEvents } from \"@shared/IpcEvents\";\nimport type { IpcRes } from \"@utils/types\";\nimport { ipcRenderer } from \"electron/renderer\";\n\nexport function invoke<T = any>(event: IpcEvents, ...args: any[]) {\n    return ipcRenderer.invoke(event, ...args) as Promise<T>;\n}\n\nexport function sendSync<T = any>(event: IpcEvents, ...args: any[]) {\n    return ipcRenderer.sendSync(event, ...args) as T;\n}\n\nconst PluginHelpers = {} as Record<string, Record<string, (...args: any[]) => Promise<any>>>;\nconst pluginIpcMap = sendSync<PluginIpcMappings>(IpcEvents.GET_PLUGIN_IPC_METHOD_MAP);\n\nfor (const [plugin, methods] of Object.entries(pluginIpcMap)) {\n    const map = PluginHelpers[plugin] = {};\n    for (const [methodName, method] of Object.entries(methods)) {\n        map[methodName] = (...args: any[]) => invoke(method as IpcEvents, ...args);\n    }\n}\n\nexport default {\n    themes: {\n        uploadTheme: async (fileName: string, fileData: string): Promise<void> => {\n            throw new Error(\"uploadTheme is WEB only\");\n        },\n        deleteTheme: async (fileName: string): Promise<void> => {\n            throw new Error(\"deleteTheme is WEB only\");\n        },\n        getThemesList: () => invoke<Array<UserThemeHeader>>(IpcEvents.GET_THEMES_LIST),\n        getThemeData: (fileName: string) => invoke<string | undefined>(IpcEvents.GET_THEME_DATA, fileName),\n        getSystemValues: () => invoke<Record<string, string>>(IpcEvents.GET_THEME_SYSTEM_VALUES),\n\n        openFolder: () => invoke<void>(IpcEvents.OPEN_THEMES_FOLDER),\n    },\n\n    updater: {\n        getUpdates: () => invoke<IpcRes<Record<\"hash\" | \"author\" | \"message\", string>[]>>(IpcEvents.GET_UPDATES),\n        update: () => invoke<IpcRes<boolean>>(IpcEvents.UPDATE),\n        rebuild: () => invoke<IpcRes<boolean>>(IpcEvents.BUILD),\n        getRepo: () => invoke<IpcRes<string>>(IpcEvents.GET_REPO),\n    },\n\n    settings: {\n        get: () => sendSync<Settings>(IpcEvents.GET_SETTINGS),\n        set: (settings: Settings, pathToNotify?: string) => invoke<void>(IpcEvents.SET_SETTINGS, settings, pathToNotify),\n\n        openFolder: () => invoke<void>(IpcEvents.OPEN_SETTINGS_FOLDER),\n    },\n\n    quickCss: {\n        get: () => invoke<string>(IpcEvents.GET_QUICK_CSS),\n        set: (css: string) => invoke<void>(IpcEvents.SET_QUICK_CSS, css),\n\n        addChangeListener(cb: (newCss: string) => void) {\n            ipcRenderer.on(IpcEvents.QUICK_CSS_UPDATE, (_, css) => cb(css));\n        },\n\n        addThemeChangeListener(cb: () => void) {\n            ipcRenderer.on(IpcEvents.THEME_UPDATE, () => cb());\n        },\n\n        openFile: () => invoke<void>(IpcEvents.OPEN_QUICKCSS),\n        openEditor: () => invoke<void>(IpcEvents.OPEN_MONACO_EDITOR),\n        getEditorTheme: () => sendSync<string>(IpcEvents.GET_MONACO_THEME),\n    },\n\n    native: {\n        getVersions: () => process.versions as Partial<NodeJS.ProcessVersions>,\n        openExternal: (url: string) => invoke<void>(IpcEvents.OPEN_EXTERNAL, url),\n        getRendererCss: () => invoke<string>(IpcEvents.GET_RENDERER_CSS),\n        onRendererCssUpdate: (cb: (newCss: string) => void) => {\n            if (!IS_DEV) return;\n\n            ipcRenderer.on(IpcEvents.RENDERER_CSS_UPDATE, (_e, newCss: string) => cb(newCss));\n        }\n    },\n\n    csp: {\n        /**\n         * Note: Only supports full explicit matches, not wildcards.\n         *\n         * If `*.example.com` is allowed, `isDomainAllowed(\"https://sub.example.com\")` will return false.\n         */\n        isDomainAllowed: (url: string, directives: string[]) => invoke<boolean>(IpcEvents.CSP_IS_DOMAIN_ALLOWED, url, directives),\n        removeOverride: (url: string) => invoke<boolean>(IpcEvents.CSP_REMOVE_OVERRIDE, url),\n        requestAddOverride: (url: string, directives: string[], callerName: string) =>\n            invoke<CspRequestResult>(IpcEvents.CSP_REQUEST_ADD_OVERRIDE, url, directives, callerName),\n    },\n\n    pluginHelpers: PluginHelpers\n};\n"],
  "mappings": ";;;;aAyBO,SAASA,EAA6BC,EAASC,EAAQ,IAAQ,CAClE,IAAIC,EACJ,OAAO,YAAaC,EAAa,CAC7B,aAAaD,CAAO,EACpBA,EAAU,WAAW,IAAM,CAAEF,EAAK,GAAGG,CAAI,CAAG,EAAGF,CAAK,CACxD,CACJ,CCXA,IAAAG,EAAwC,6BCRxC,IAAAC,EAA4B,6BAErB,SAASC,EAAgBC,KAAqBC,EAAa,CAC9D,OAAO,cAAY,OAAOD,EAAO,GAAGC,CAAI,CAC5C,CAEO,SAASC,EAAkBF,KAAqBC,EAAa,CAChE,OAAO,cAAY,SAASD,EAAO,GAAGC,CAAI,CAC9C,CAEA,IAAME,EAAgB,CAAC,EACjBC,EAAeF,gCAA+D,EAEpF,OAAW,CAACG,EAAQC,CAAO,IAAK,OAAO,QAAQF,CAAY,EAAG,CAC1D,IAAMG,EAAMJ,EAAcE,CAAM,EAAI,CAAC,EACrC,OAAW,CAACG,EAAYC,CAAM,IAAK,OAAO,QAAQH,CAAO,EACrDC,EAAIC,CAAU,EAAI,IAAIP,IAAgBF,EAAOU,EAAqB,GAAGR,CAAI,CAEjF,CAEA,IAAOS,EAAQ,CACX,OAAQ,CACJ,YAAa,MAAOC,EAAkBC,IAAoC,CACtE,MAAM,IAAI,MAAM,yBAAyB,CAC7C,EACA,YAAa,MAAOD,GAAoC,CACpD,MAAM,IAAI,MAAM,yBAAyB,CAC7C,EACA,cAAe,IAAMZ,wBAAwD,EAC7E,aAAeY,GAAqBZ,wBAAqDY,CAAQ,EACjG,gBAAiB,IAAMZ,+BAAgE,EAEvF,WAAY,IAAMA,2BAAyC,CAC/D,EAEA,QAAS,CACL,WAAY,IAAMA,qBAAqF,EACvG,OAAQ,IAAMA,iBAAwC,EACtD,QAAS,IAAMA,gBAAuC,EACtD,QAAS,IAAMA,kBAAyC,CAC5D,EAEA,SAAU,CACN,IAAK,IAAMG,sBAAyC,EACpD,IAAK,CAACW,EAAoBC,IAA0Bf,uBAAqCc,EAAUC,CAAY,EAE/G,WAAY,IAAMf,6BAA2C,CACjE,EAEA,SAAU,CACN,IAAK,IAAMA,sBAAsC,EACjD,IAAMgB,GAAgBhB,uBAAsCgB,CAAG,EAE/D,kBAAkBC,EAA8B,CAC5C,cAAY,2BAA+B,CAACC,EAAGF,IAAQC,EAAGD,CAAG,CAAC,CAClE,EAEA,uBAAuBC,EAAgB,CACnC,cAAY,wBAA2B,IAAMA,EAAG,CAAC,CACrD,EAEA,SAAU,IAAMjB,uBAAoC,EACpD,WAAY,IAAMA,2BAAyC,EAC3D,eAAgB,IAAMG,yBAA2C,CACrE,EAEA,OAAQ,CACJ,YAAa,IAAM,QAAQ,SAC3B,aAAegB,GAAgBnB,wBAAsCmB,CAAG,EACxE,eAAgB,IAAMnB,yBAAyC,EAC/D,oBAAsBiB,GAAiC,CAIvD,CACJ,EAEA,IAAK,CAMD,gBAAiB,CAACE,EAAaC,IAAyBpB,8BAAiDmB,EAAKC,CAAU,EACxH,eAAiBD,GAAgBnB,6BAA+CmB,CAAG,EACnF,mBAAoB,CAACA,EAAaC,EAAsBC,IACpDrB,iCAA6DmB,EAAKC,EAAYC,CAAU,CAChG,EAEA,cAAejB,CACnB,ED9EA,gBAAc,kBAAkB,gBAAiBkB,CAAa,EAG1D,SAAS,WAAa,QACtBC,2BAAmC,GASnC,gBAAc,kBAAkB,SAAUC,EAASF,EAAc,SAAS,GAAG,CAAC,EAC9E,gBAAc,kBAAkB,gBAAiBA,EAAc,SAAS,GAAG,EAC3E,gBAAc,kBAAkB,WAAYA,EAAc,SAAS,cAAc",
  "names": ["debounce", "func", "delay", "timeout", "args", "import_renderer", "import_renderer", "invoke", "event", "args", "sendSync", "PluginHelpers", "pluginIpcMap", "plugin", "methods", "map", "methodName", "method", "VencordNative_default", "fileName", "fileData", "settings", "pathToNotify", "css", "cb", "_", "url", "directives", "callerName", "VencordNative_default", "invoke", "debounce"]
}
